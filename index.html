<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CTAS Triage Tool - Advanced</title>
<style>
  body { font-family: Arial, sans-serif; padding: 1em; background: #f4f4f4; }
  .container { max-width: 600px; margin: auto; background: #fff; padding: 1em; border-radius: 8px; }
  h2 { text-align: center; }
  label { display: block; margin-top: 1em; font-weight: bold; }
  input, select, textarea { width: 100%; padding: 0.5em; margin-top: 0.3em; }
  button { margin-top: 1em; padding: 0.7em; width: 100%; background: #007BFF; color: white; border: none; border-radius: 4px; font-size: 1em; }
  .result { margin-top: 1em; padding: 1em; border-radius: 4px; background: #e9ecef; }
  .override-warning { color: red; font-weight: bold; margin-top: 0.5em; }
</style>
</head>
<body>
<div class="container">
<h2>CTAS Triage Tool</h2>

<label>Systolic BP</label>
<input type="number" id="sbp" placeholder="e.g., 120">

<label>Diastolic BP</label>
<input type="number" id="dbp" placeholder="e.g., 80">

<label>Heart Rate</label>
<input type="number" id="hr" placeholder="e.g., 80">

<label>Respiratory Rate</label>
<input type="number" id="rr" placeholder="e.g., 16">

<label>Oxygen Saturation (%)</label>
<input type="number" id="oxygen" placeholder="e.g., 98">

<label>Pain Score (0-10)</label>
<input type="number" id="pain" placeholder="e.g., 5">

<label>Main Complaint Category</label>
<select id="category" onchange="updateSubComplaints()">
  <option value="">--Select--</option>
  <option value="Cardiovascular">Cardiovascular</option>
  <option value="Respiratory">Respiratory</option>
  <option value="Neurological">Neurological</option>
  <option value="GI">GI / Abdominal</option>
  <option value="Trauma">Trauma / Injury</option>
  <option value="Other">Other</option>
</select>

<label>Specific Complaint</label>
<select id="complaint"></select>

<button onclick="calculateCTAS()">Calculate CTAS Level</button>
<div id="result" class="result"></div>

<label>Override CTAS Level (Optional)</label>
<select id="override" onchange="checkOverride()">
  <option value="">--No Override--</option>
  <option value="1">Level 1 - Resuscitation</option>
  <option value="2">Level 2 - Emergent</option>
  <option value="3">Level 3 - Urgent</option>
  <option value="4">Level 4 - Less Urgent</option>
  <option value="5">Level 5 - Non-Urgent</option>
</select>
<div id="overrideWarning" class="override-warning" style="display:none;">You are overriding the system recommendation. Please justify below:</div>
<textarea id="overrideComment" style="display:none;" placeholder="Enter justification for override"></textarea>

</div>

<script>
const complaints = {
  "Cardiovascular": ["Chest Pain","Palpitations","Hypertension","Hypotension","Syncope"],
  "Respiratory": ["Shortness of Breath","Asthma","COPD Exacerbation"],
  "Neurological": ["Stroke Symptoms","Seizure","Severe Headache","Altered Mental Status"],
  "GI": ["Abdominal Pain","GI Bleed","Vomiting/Diarrhea"],
  "Trauma": ["Major Trauma","Minor Injury","Burns"],
  "Other": ["Fever","General Weakness","Psychiatric","Other"]
};

function updateSubComplaints() {
  const category = document.getElementById('category').value;
  const subSelect = document.getElementById('complaint');
  subSelect.innerHTML = '';
  if (complaints[category]) {
    complaints[category].forEach(c => {
      let opt = document.createElement('option');
      opt.value = c;
      opt.textContent = c;
      subSelect.appendChild(opt);
    });
  }
}

function calculateCTAS() {
  const sbp = parseInt(document.getElementById('sbp').value);
  const dbp = parseInt(document.getElementById('dbp').value);
  const hr = parseInt(document.getElementById('hr').value);
  const rr = parseInt(document.getElementById('rr').value);
  const oxygen = parseInt(document.getElementById('oxygen').value);
  const pain = parseInt(document.getElementById('pain').value);
  const complaint = document.getElementById('complaint').value;

  let level = 5; let desc = "Non-Urgent"; let target = "120 minutes";

  if (sbp < 80 || rr < 8 || rr > 40 || oxygen < 85 || hr < 40 || hr > 140) {
    level = 1; desc = "Resuscitation"; target = "Immediate";
  } else if (sbp < 90 || oxygen < 90 || complaint === "Chest Pain" || complaint === "Stroke Symptoms") {
    level = 2; desc = "Emergent"; target = "15 minutes";
  } else if (pain >= 4 || hr > 120 || hr < 50) {
    level = 3; desc = "Urgent"; target = "30 minutes";
  } else if (pain >= 1) {
    level = 4; desc = "Less Urgent"; target = "60 minutes";
  }

  document.getElementById('result').innerHTML = `<strong>Recommended CTAS Level ${level}</strong>: ${desc}<br>Target Time: ${target}`;
  document.getElementById('override').dataset.recommended = level;
}

function checkOverride() {
  const overrideSelect = document.getElementById('override');
  const recommended = overrideSelect.dataset.recommended;
  const chosen = overrideSelect.value;
  if (chosen && chosen !== recommended) {
    document.getElementById('overrideWarning').style.display = 'block';
    document.getElementById('overrideComment').style.display = 'block';
  } else {
    document.getElementById('overrideWarning').style.display = 'none';
    document.getElementById('overrideComment').style.display = 'none';
  }
}
</script>
</body>
</html>
